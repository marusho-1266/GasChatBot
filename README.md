# FAQ自動応答チャットボットシステム

## 概要

このシステムは、Google Apps Script (GAS) を利用したWebアプリケーションとして動作する、よくある質問（FAQ）に自動応答するチャットボットシステムです。ユーザーからの質問を受け取り、Google スプレッドシートで管理されているFAQデータベースから最適な回答を検索・返却します。

## 特徴

- シンプルで使いやすいチャットインターフェース
- Google スプレッドシートによるFAQデータの簡単な管理
- キーワードマッチングと文字列類似度計算による回答検索
- レスポンシブデザインによるモバイル対応
- サーバー不要で Google Apps Script のみで動作

## セットアップ手順

### 1. FAQデータベースの作成

1. 新しい Google スプレッドシートを作成
2. 最初のシート名を `FAQData` に変更
3. 以下のヘッダーを設定（A1〜E1セル）:
   - A1: 質問ID
   - B1: 質問文
   - C1: 回答文
   - D1: キーワード（カンマ区切り）
   - E1: カテゴリ
4. サンプルFAQデータをいくつか追加（例）:
   - ID: 1, 質問: "営業時間は何時ですか？", 回答: "当店の営業時間は平日9:00〜18:00、土日祝日は10:00〜17:00です。", キーワード: "営業時間,営業,時間,開店,閉店", カテゴリ: "一般情報"

### 2. Google Apps Script プロジェクトの作成

1. FAQデータベースのスプレッドシートから「拡張機能」>「Apps Script」を選択
2. スクリプトファイル（Code.gs）を作成し、提供されたGASバックエンドコードを貼り付け
3. 「ファイル」>「新規作成」>「HTMLファイル」で新しいHTMLファイルを作成
4. ファイル名を `Index` と設定し、提供されたHTMLコードを貼り付け

### 3. プロジェクトのデプロイ

1. Apps Scriptエディタで「デプロイ」>「新しいデプロイ」をクリック
2. 「ウェブアプリ」を選択
3. 以下の設定を行う:
   - 説明: FAQ チャットボット
   - 次のユーザーとしてアプリを実行: ご自身のアカウント
   - アクセスできるユーザー: 必要に応じて選択（全員、または特定のユーザーのみ）
4. 「デプロイ」ボタンをクリック
5. 表示されたウェブアプリのURLをコピー（このURLでチャットボットにアクセスできます）

## 使用方法

### FAQデータの管理

1. Google スプレッドシートでFAQデータを追加・編集
2. 各質問には関連するキーワードを漏れなく登録（カンマ区切り）
3. カテゴリを活用して、FAQの分類を管理

### チャットボットの利用

1. デプロイされたウェブアプリのURLにアクセス
2. チャットインターフェースで質問を入力
3. 送信ボタンをクリックすると、システムが最適な回答を表示

## カスタマイズ

### スタイルのカスタマイズ

HTMLファイル内のCSSを編集することで、チャットボットのデザインをカスタマイズできます。企業のブランドカラーやロゴを適用することも可能です。

### 検索ロジックの調整

検索の精度を調整したい場合は、以下のパラメータを変更できます:

- `コード.gs` の `searchFAQ` 関数内の `threshold` 値（デフォルト: 0.3）
- `calculateMatchingScore` 関数内のスコア配分

### 機能拡張のアイデア

- ユーザーからのフィードバック機能の追加
- FAQ閲覧履歴やよく使われる質問の統計収集
- 回答が見つからない場合のお問い合わせフォームへの誘導
- 外部AI API（例: OpenAI）との連携

## トラブルシューティング

### チャットボットが応答しない場合

1. スプレッドシートの `FAQData` シートが正しく設定されているか確認
2. Apps Scriptのデプロイが正常に完了しているか確認
3. GASの実行ログでエラーを確認: 「実行」>「現在のプロジェクトのトリガー」>「実行履歴」

### 適切な回答が返ってこない場合

1. FAQデータのキーワードを充実させる
2. 似た質問のバリエーションを追加する
3. `threshold` 値を調整する（低くすると回答が見つかりやすくなるが、精度は下がる）

## 制限事項

- Google Apps Scriptの実行時間制限（6分/実行）があります
- 同時アクセス数に制限があります
- スプレッドシートのデータ量に制限があります